# Stonks
## Goal
I decided to try something noone else has before. I made a bot to automatically trade stonks for me using AI and machine learning. I wouldn't believe you if you told me it's unsecure! vuln.c 

`nc mercury.picoctf.net 16439`
## HINTS
Okay, maybe I'd believe you if you find my API key.

## WRITE UP

Use the netcat command given in the question

`$ nc mercury.picoctf.net 16439`

![image](https://github.com/vishwatejD/picoCTF/assets/141154035/9f257e94-9157-4f03-8e2f-9e16116f437c)



~~ I searched online and got to know how the api key is stored on the stack~~



We can access the api key by using `%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x%x`

> RESOURCE USED:- https://www.tutorialspoint.com/c_standard_library/c_function_sprintf.htm



![image](https://github.com/vishwatejD/picoCTF/assets/141154035/c6906b15-749c-4583-aff9-152e0fcb61f7)

This string of text is in hexadecimal format, this can be converted to ascii by using online converters.

But, now the problem is the flag is encrypted.
Every four characters are reversed.

This can be decrypted manually by reversing every four characters.

![image](https://github.com/vishwatejD/picoCTF/assets/141154035/680851fa-a900-4712-abb8-d659c7abb710)

FLAG:- picoCTF{I_l05t_4ll_my_m0n3y_c7cb6cae}

___


# babygame01
## GOAL
Get the flag and reach the exit.

Additional details will be available after launching your challenge instance.

Welcome to BabyGame! Navigate around the map and see what you can find! The game is available to download here. There is no source available, so you'll have to figure your way around the map. You can connect with it using 

`$ nc saturn.picoctf.net 62073`

## HINTS
1.Use 'w','a','s','d' to move around.

2. There may be secret commands to make your life easy.



## WRITE UP

I first used the command given, `$ nc saturn.picoctf.net 62073`



Then used the w,a,s,d keys to move the `@` to the `X`.



I just got `You Win!` but no flag.



Then I tried to read the code behind this output. I found using the command `$ file game` that this file is a elf 32 bit excecutable file.



~~ searched online for decompilers of that type of file~~

> RESOURCE USED :- https://dogbolt.org/



I added the file in the decompiler and went through the code.

The variable local_aa4 is responsible for then value of the flag. It says that the value of that variable must not be 0. In the code Thus we must move the `@`  to a place where we get the flag. ~~ I tried moving it all around the map but no flag. I thought what if the flag is outside the map, by chance i got the flag when the @ is moved 4 places to the left of point (0,0). I searched online for what the logic behind that is and found that all the following commands start at 0 thus the flag must be before 0.~~

![image](https://github.com/vishwatejD/picoCTF/assets/141154035/d5efd09c-93c4-423e-8ec7-89239223ddbf)



`if (local_aa4 != '\0') {
    puts("flage");
    win();
    fflush(_stdout);`

![image](https://github.com/vishwatejD/picoCTF/assets/141154035/5f9136c9-9cc5-403e-8fa0-da95440d461a)


![Screenshot from 2023-11-14 22-42-41](https://github.com/vishwatejD/picoCTF/assets/141154035/cb3b5e1d-0d22-49aa-b923-39af389822af)

FLAG:- **picoCTF{gamer_m0d3_enabled_e282d353}**


___


# buffer overflow 0
## GOAL
Smash the stack Let's start off simple, can you overflow the correct buffer? The program is available here. You can view source here. And connect with it using: 
`nc saturn.picoctf.net 65443`

## HINTS
1. How can you trigger the flag to print?
2. If you try to do the math by hand, maybe try and add a few more characters. Sometimes there are things you aren't expecting.
3. `Run man` gets and read the BUGS section. How many characters can the program really read?

## WRITE UP
 I opened the code `vuln.c` and went through it.

``` c
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <signal.h>

#define FLAGSIZE_MAX 64

char flag[FLAGSIZE_MAX];

void sigsegv_handler(int sig) {
  printf("%s\n", flag);
  fflush(stdout);
  exit(1);
}

void vuln(char *input){
  char buf2[16];
  strcpy(buf2, input);
}

int main(int argc, char **argv){
  
  FILE *f = fopen("flag.txt","r");
  if (f == NULL) {
    printf("%s %s", "Please create 'flag.txt' in this directory with your",
                    "own debugging flag.\n");
    exit(0);
  }
  
  fgets(flag,FLAGSIZE_MAX,f);
  signal(SIGSEGV, sigsegv_handler); // Set up signal handler
  
  gid_t gid = getegid();
  setresgid(gid, gid, gid);


  printf("Input: ");
  fflush(stdout);
  char buf1[100];
  gets(buf1); 
  vuln(buf1);
  printf("The program will exit now\n");
  return 0;
}
```

In one of the lines in the code it mentions that the input can take only 16 characters.

![image](https://github.com/vishwatejD/picoCTF/assets/141154035/397ab926-7721-4f0d-886f-982c69a05e8e)


 I tried inputting more than 16 characters which caused the code to crash and give the Flag.

 ![image](https://github.com/vishwatejD/picoCTF/assets/141154035/16bda29e-57fc-421c-90e9-c73756d3d23f)


 FLAG: - picoCTF{ov3rfl0ws_ar3nt_that_bad_c5ca6248}
 


